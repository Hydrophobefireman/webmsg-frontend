(window.webpackJsonp=window.webpackJsonp||[]).push([[3,4],{12:function(e,t,n){"use strict";n.r(t);var s=n(2),r=n(0);n(8);const o=(e,t)=>({element:"button",children:[{element:"a",textContent:e,attrs:{href:`#/chat/${t}`,class:"result_name"}}],events:{click:e=>(Object(r.load)(`/chat/${t}`),e.preventDefault())},attrs:{class:"searchresult"}});let c;const i={element:"div",attrs:{},children:[Object(s.matInput)("searchHint","Search for users","userSearch",{async keydown(e){if(85===e.keyCode&&e.ctrlKey)return e.preventDefault(),void(this.$$element.value="");if(13===e.keyCode){const e=Object(r.getElement)(this,"resultBox");e.attrs.textContent="",e.update(),e.children=[],e.reRender();const t=(this.attrs.value||"").trim();if(t){const n=Object(r.getElement)(this,"search-spinner");n.add();const c=await s.Requests.get(`/api/user-search/tokens/${await s.utilService.getIntegrity()}`),i=await c.text(),a=await s.Requests.post("/api/users/",!0,Object(r.urlencode)({token:i,user:t})),d=(await a.json()).users||[];if(!d.length)return e.attrs.textContent="No Users Found",e.update(),n.remove();const h=[];for(const e of d)h.push(o(e.user,e.chat_id));e.children=h,n.remove(),e.reRender(e)}}}}),{idx:"search-spinner",element:"mat-spinner",attrs:{svgstyle:"margin:auto;margin-top:10px"},onrender(){this.remove()}},{element:"div",attrs:{},idx:"resultBox",children:[]}]},a={idx:"prevChatsUI",element:"div",attrs:{style:{width:"80%",margin:"auto","border-top":"1px solid #000","margin-top":"10px"}},async onrender(){},children:[{attrs:{boxstyle:Object(r.makeCSS)({"margin-top":"20px"})},element:"mat-checkbox",events:{async check(e){Object(s.retry)(()=>(function(e){const t=Object(r.getElement)(this,"prevChatsData"),n=Object(r.getElement)(this,"prevChatsMessage");this.attrs._checked=e.checked,e.checked?async function(){if(c)t.children=c,t.add();else{this.remove(),n.remove();const e=Object(r.getElement)(this,"loading-spinner");e.add();const i=await s.Requests.post("/api/chat_ids/",!0,Object(r.urlencode)({user:await s.utilService.getUser(!1,!0)})),a=(await i.json()).previous_chats||[];if(!a.length)throw e.remove(),n.attrs.textContent="An error occured while searching for your chats",n.update(),new Error("$bad length");const d=[];for(const e of a)d.push(o(e.user,e.chat_id));c=d,t.children=d,t.safeRerender(t),e.remove(),this.add()}n.add(),n.attrs.textContent="Your Previous Chats",n.update()}.call(this):(n.attrs.textContent="Click to show your previous chats",n.update(),t.remove())}).call(this,e),1,e=>{console.log(e),Object(r.getElement)(this,"loading-spinner").remove();const t=Object(r.getElement)(this,"prevChatsMessage");return t.attrs.textContent="Could not find previus chats",t.update(),this.remove()})}}},{idx:"prevChatsMessage",element:"div",textContent:"Click to show your previous chats"},{idx:"loading-spinner",element:"mat-spinner",attrs:{svgstyle:"margin:auto"},onrender(){this.remove()}},{idx:"prevChatsData",element:"div",onrender(){this.remove()}}]};t.default={element:"div",route:"/u/",attrs:{},async beforeRender(e){r.$.empty(this.getRouter().root);const t=Object(s.noAuth)(this.currentRoute,this.getRouter().navData);if(t)return t;const n=e[0];return n&&n===user?void 0:(Object(r.load)(`/u/${user}`),{stopExec:!0})},onrender:()=>(console.log("TODO"),document.documentElement.style.backgroundColor=document.body.style.backgroundColor="#ffffff"),onUnmount:()=>document.documentElement.style.backgroundColor=document.body.style.backgroundColor="#e3e3e3",children:[i,a]}},8:function(e,t,n){"use strict";n.r(t),n.d(t,"MatCheckBox",function(){return r});var s=n(0);class r extends HTMLElement{set checked(e){const t=this.button;this._checked=!!e,e?t.classList.add("clicked"):t.classList.remove("clicked");const n=new Event("check");n.checked=this.checked,this.dispatchEvent(n)}set oncheck(e){this.eventListener=e,this.addEventListener("check",e)}get checked(){return this._checked}static get observedAttributes(){return["checked","boxstyle","buttonstyle"]}attributeChangedCallback(e,t,n){if("checked"===e){let t;return t="false"!==n&&"0"!==n,"checked"===e?this.checked=t:void 0}return"boxstyle"===e?this.boxtyle=n:"buttonstyle"===e?this.buttonstyle=n:void 0}_createTemplate(){const e=document.createElement("div"),t=document.createElement("button");e.appendChild(t);const n=document.createElement("template"),s=document.createElement("style");return s.innerHTML="div{-webkit-tap-highlight-color:transparent;background-color:#fff;cursor:pointer;border-radius:100px;height:20px;width:50px;display:inline-flex;border:2px solid #e3e3e3}button{box-shadow:0 1px 5px 0 #0009;display:block;margin-top:auto;margin-bottom:auto;height:inherit;border-radius:100%;border:none;width:20px;transition:all .2s ease-in-out 0s;cursor:pointer;outline:0}button.clicked{margin-left:30px;background-color:#033577}",n.innerHTML=s.outerHTML+e.outerHTML,n}set boxtyle(e){return this.box.style=e}set buttonstyle(e){return this.button.style=e}constructor(e,t){super();const n=this._createTemplate();this.attachShadow({mode:"open"}).appendChild(n.content.cloneNode(!0)),this.button=(()=>this.shadowRoot.querySelector("button"))(),this.box=(()=>this.shadowRoot.querySelector("div"))(),this.box.addEventListener("click",e=>(e.stopImmediatePropagation(),this.checked?this.checked=!1:this.checked=!0)),e&&(this.box.style=e),t&&(this.button.style=t)}}Object(s.safeDefine)("mat-checkbox",r)}}]);