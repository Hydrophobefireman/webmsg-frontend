!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){e.exports=r(6)},function(e,t){function r(e,t,r,n,s,a,o){try{var i=e[a](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,s)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise(function(s,a){var o=e.apply(t,n);function i(e){r(o,s,a,i,c,"next",e)}function c(e){r(o,s,a,i,c,"throw",e)}i(void 0)})}}},function(e,t,r){var n=r(8);e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){n(e,t,r[t])})}return e}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTYuNSA2djExLjVjMCAyLjIxLTEuNzkgNC00IDRzLTQtMS43OS00LTRWNWMwLTEuMzggMS4xMi0yLjUgMi41LTIuNXMyLjUgMS4xMiAyLjUgMi41djEwLjVjMCAuNTUtLjQ1IDEtMSAxcy0xLS40NS0xLTFWNkgxMHY5LjVjMCAxLjM4IDEuMTIgMi41IDIuNSAyLjVzMi41LTEuMTIgMi41LTIuNVY1YzAtMi4yMS0xLjc5LTQtNC00UzcgMi43OSA3IDV2MTIuNWMwIDMuMDQgMi40NiA1LjUgNS41IDUuNXM1LjUtMi40NiA1LjUtNS41VjZoLTEuNXoiLz48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PC9zdmc+Cg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZwogIHdpZHRoPSI0MCIKICBoZWlnaHQ9IjQwIgogIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICB2aWV3Qm94PSIwIDAgMjQgMjQiCj4KICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIj48L3BhdGg+CiAgPHBhdGgKICAgIGQ9Ik0xMiA4YzEuMSAwIDItLjkgMi0ycy0uOS0yLTItMi0yIC45LTIgMiAuOSAyIDIgMnptMCAyYy0xLjEgMC0yIC45LTIgMnMuOSAyIDIgMiAyLS45IDItMi0uOS0yLTItMnptMCA2Yy0xLjEgMC0yIC45LTIgMnMuOSAyIDIgMiAyLS45IDItMi0uOS0yLTItMnoiCiAgPjwvcGF0aD4KPC9zdmc+Cg=="},function(e,t){var r="/sw.js";Object.defineProperty(t,"__esModule",{value:!0}),t.default={register:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!navigator.serviceWorker&&navigator.serviceWorker.register(r,e)}},e.exports=t.default},function(e,t,r){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),s=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,a=s&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r(7),s)n.regeneratorRuntime=a;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var r,n=Object.prototype,s=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag",u="object"==typeof e,l=t.regeneratorRuntime;if(l)u&&(e.exports=l);else{(l=t.regeneratorRuntime=u?e.exports:{}).wrap=y;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",m={},g={};g[o]=function(){return this};var v=Object.getPrototypeOf,_=v&&v(v(T([])));_&&_!==n&&s.call(_,o)&&(g=_);var x=C.prototype=k.prototype=Object.create(g);w.prototype=x.constructor=C,C.constructor=w,C[c]=w.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(x),e},l.awrap=function(e){return{__await:e}},I($.prototype),$.prototype[i]=function(){return this},l.AsyncIterator=$,l.async=function(e,t,r,n){var s=new $(y(e,t,r,n));return l.isGeneratorFunction(t)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(x),x[c]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},l.values=T,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,s){return i.type="throw",i.arg=e,t.next=n,s&&(t.method="next",t.arg=r),!!s}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),u=s.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var s=n.arg;L(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),m}}}function y(e,t,r,n){var s=t&&t.prototype instanceof k?t:k,a=Object.create(s.prototype),o=new M(n||[]);return a._invoke=function(e,t,r){var n=h;return function(s,a){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===s)throw a;return R()}for(r.method=s,r.arg=a;;){var o=r.delegate;if(o){var i=E(o,r);if(i){if(i===m)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=b(e,t,r);if("normal"===c.type){if(n=r.done?f:d,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,o),a}function b(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function k(){}function w(){}function C(){}function I(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function $(e){var t;this._invoke=function(r,n){function a(){return new Promise(function(t,a){!function t(r,n,a,o){var i=b(e[r],e,n);if("throw"!==i.type){var c=i.arg,u=c.value;return u&&"object"==typeof u&&s.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)}):Promise.resolve(u).then(function(e){c.value=e,a(c)},function(e){return t("throw",e,a,o)})}o(i.arg)}(r,n,t,a)})}return t=t?t.then(a,a):a()}}function E(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,E(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var s=b(n,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,m;var a=s.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(s.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return a.next=a}}return{next:R}}function R(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){},function(e,t,r){},function(e){e.exports={}},function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),a=r(1),o=r.n(a);const i=e=>e.constructor===Object,c=e=>{if("string"==typeof e)return"/"===e[0]?location.hash=e:location.hash=`/${e}`},u=new class{emit(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}listen(e,t){return this.EventCache[e]=t,window.addEventListener(e,t)}detroyEvt(e,t){window.removeEventListener(e,t)}destroyAll(){for(var e=Object.keys(this.EventCache),t=0;t<e.length;t++){const r=e[t];this.detroyEvt(r,this.EventCache[r])}}constructor(){this.EventCache={}}},l=function(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location;if("#"===r[0])e=r.substr(1);else try{e=(t=new URL(r)).hash.substr(1)}catch(t){e="/",console.log(t)}const n=e.split("?"),s=[0===e.length?"/":n[0],n[1]];return{path:s[0],qs:s[1]}},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return[...Array(e)].join(".").replace(/[.]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))},d=(()=>{const e=document.createElement("style");return e.innerHTML="",document.head.appendChild(e),e.sheet})(),p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return Array.from(t.rules).filter(t=>t.selectorText===e)[0]},f=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;const n=Object.keys(t);for(var s=0;s<n.length;s++){const c=n[s];if(!["$$element","$$parent"].includes(c)){const n=t[c];if("class"===c)e.className="string"==typeof n?n:[...n].join(" ");else if("events"===c)for(var a=Object.keys(n),o=0;o<a.length;o++){const t=a[o],r=n[t];e.addEventListener(t,r)}else if("style"===c){let s,a,o;if(s=i(n)?_(n):n,o=e.getAttribute("_routercontent")||t._routercontent){const e=p(`[_routercontent="${o}"]`);e?e.style=s:a=!0}else o=h(),a=!0;a&&(e.setAttribute("_routercontent",o),r.insertRule(`[_routercontent='${o}']{${s}}`))}else["___innerHTML___","innerText","textContent"].includes(c)?"___innerHTML___"===c?e.innerHTML=n:e.textContent=n:e.setAttribute(c,n)}}},m={q(e){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?document.querySelector(e):Array.from(document.querySelectorAll(e))},id:e=>document.getElementById(e),className(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=Array.from(document.getElementsByClassName(e));return t?r[0]:r},create(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;const n=document.createElement(e);return t&&"object"==typeof t&&f(n,t,r),n},get:(e,t)=>e.getAttribute(t),set:(e,t,r)=>e.setAttribute(t,r),empty:e=>{let t;for(t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}},g=e=>e instanceof Function,v=e=>"AsyncFunction"===e.constructor.name,_=e=>{if("string"==typeof e)return e;const t=[];for(var r=Object.keys(e),n=0;n<r.length;n++){const s=r[n];t.push(`${s}:${e[s]}`)}return t.join(";")},x=e=>window.URLSearchParams?new URLSearchParams(e):`${Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}`;const y=e=>{try{const t={hour:"numeric",hour12:!0,minute:"numeric"},r=new Date(e),n=new Date;return r.getFullYear()!==n.getFullYear()&&(t.year="numeric"),function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}(r,n)||(t.month=t.day="numeric"),Intl.DateTimeFormat("auto",t).format(r)}catch(e){return console.log(e),r.toLocaleString()}},b=()=>(new Date).getTime(),k=(e,t)=>{if(e){const r=e.routeCache();return r?r[t]:null}return null};function w(e,t){if(!window.customElements.get(e))return window.customElements.define(e,t)}m.q("noscript").remove();const C={element:"a",attrs:{href:"/#/",style:{display:"block",color:"#000"}},events:{click(e){e.preventDefault(),location.hash="/"}},textContent:"Click Here to Go Back",children:[]},I={display:"block","text-align":"center","font-family":"sans-serif",padding:"8px",margin:"auto","font-weight":"bold"},$=new class{parseHash(e){return l(e)}__runConditionals(){var e=this;return o()(s.a.mark(function t(){var r,n,a,o,i,c,u,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=[...document.querySelectorAll("[_routerif]")],n=0;case 2:if(!(n<r.length)){t.next=22;break}if(a=r[n],o=m.get(a,"_routerif"),i=m.get(a,"_routerthen"),!new Function("$",`return ${o}`).call(e,a)){t.next=12;break}(c=a.$)&&(a.replaceWith(c),i&&new Function("$",i).call(e,c)),t.next=19;break;case 12:if(!(a.$ instanceof HTMLElement)){t.next=14;break}return t.abrupt("continue",19);case 14:u={_routerif:o},i&&(u._routerthen=i),(l=m.create("router-data",u)).$=a,a.replaceWith(l);case 19:n++,t.next=2;break;case 22:case"end":return t.stop()}},t,this)}))()}__runEventListeners(){var e=this;return o()(s.a.mark(function t(){var r,n,a,o,i,c,u,l,h;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=m.q("[_routerEvt][_routerAct]",!1),n=!0,a=!1,o=void 0,t.prev=4,i=r[Symbol.iterator]();!(n=(c=i.next()).done);n=!0)u=c.value,l=m.get(u,"_routerEvt"),h=m.get(u,"_routerAct"),u[l]=(()=>{new Function(h).call(e)});t.next=12;break;case 8:t.prev=8,t.t0=t.catch(4),a=!0,o=t.t0;case 12:t.prev=12,t.prev=13,n||null==i.return||i.return();case 15:if(t.prev=15,!a){t.next=18;break}throw o;case 18:return t.finish(15);case 19:return t.finish(12);case 20:case"end":return t.stop()}},t,this,[[4,8,12,20],[13,,15,19]])}))()}_runDirectives(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.__runConditionals();case 2:e.__runEventListeners();case 3:case"end":return t.stop()}},t,this)}))()}_callFuncWithThis(e,t,r,n){if(v(e))return e.apply(t,[n]).then(e=>(r&&(e||{}).stopUpdate&&f(r,t.attrs),e));{const s=e.apply(t,[n]);return r&&((s||{}).stopUpdate||f(r,t.attrs)),s}}_setVars(e){this.stopSubsequentRenders=!1,this.root=e,this.routeMap={},this.routes=[],this.routeCache={},this.unMountFn=(()=>{}),this.unmountRoute=(()=>{this.unMountFn(),this.routeCache={}}),this.statusHandler={404:{element:"div",attrs:{style:I},textContent:"The Page you are requesting was not found",children:[C]},500:{element:"div",attrs:{style:I},textContent:"An Error Occured while trying to process your request",children:[C]}}}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.$ROOT||m.id("app-root")||m.q("body");this._setVars(e),window.onhashchange=(e=>(this.navData=e,this.routeChange(),this._runDirectives())),this._runDirectives()}isUserGoingBack(e){const t=this.navData||{};return!(`${location.protocol}//${location.host}/#${e}`!=t.oldURL||(console.log("Same url navigation"),0))}routeParser(e){return this.parseHash(e).path}load(e){return c(e)}lazyload(e,t,r){r?this.registerRoute(r):this.registerRoute({route:e,element:"div",textContent:"loading",attrs:{style:{margin:"100px"}}});const n=this.getRouteName(this.currentRoute)===e;return n&&this.startLoad(),t.then(e=>{if(this.registerRoute(e.default),n)return this.startLoad()})}get currentQS(){return this.parseHash(location.hash).qs}get currentRoute(){return this.routeParser(location.href)}startLoad(){this.routeChange()}pushStatus(e,t){const r=this.statusHandler[e];return r.textContent=t||r.textContent,r?this.render(r,this.root,!0):this.render(this.statusHandler[404])}getRouteName(e){const t=e.split("/").filter(e=>e)[0];return t?`/${t}/`:"/"}isValidRoute(e){if(this.routes.includes(e))return{res:!0,args:null,_fRoute:e};try{const t=e.split("/").filter(e=>e),r=`/${t[0]}/`;return this.routes.includes(r)?{res:!0,args:t.slice(1),_fRoute:r}:{res:!1}}catch(e){return console.log(e),{res:!1}}}routeChange(){const e=this.routeParser(location.href),t=this.isValidRoute(e),r=t.res,n=t.args,s=t._fRoute;r?(console.log("rendering"),this.render(this.routeMap[s],this.root,!0,n)):this.render(this.statusHandler[404],this.root,!0,n)}__toSets(e){"string"==typeof e.attrs.class?e.attrs.class=new Set([e.attrs.class]):Array.isArray(e.attrs.class)&&(e.attrs.class=new Set(e.attrs.class))}__objDef(e,t,r,n,a){var i=this;const c=()=>e.$$element;e.attrs=e.attrs||{},this.__toSets(e),e.getRouter=(()=>this),e.update=(()=>{if(c()&&e.attrs)return f(c(),e.attrs)}),e.remove=(()=>{if(c().parentNode)return c().replaceWith((()=>{const t=m.create("router-data");return e._$routerData=t,t})())}),e.add=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";e._$routerData&&(e._$routerData.replaceWith(c()),e._$routerData=void 0),t&&(c().style.display=t)},e.routeCache=(()=>this.routeCache),e.reRender=o()(s.a.mark(function o(){var u,l=arguments;return s.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u=l.length>0&&void 0!==l[0]?l[0]:e,e.attrs._routercontent=c().getAttribute("_routercontent"),s.t0=c(),s.next=5,i.render(u,t,r,n,a);case 5:return s.t1=s.sent,s.abrupt("return",s.t0.replaceWith.call(s.t0,s.t1));case 7:case"end":return s.stop()}},o,this)})),e.safeRerender=(t=>{e.add(),e.reRender(t),e.add()})}render(e,t){var r=this,n=arguments;return o()(s.a.mark(function a(){var o,i,c,u,l,h,d,p,f,_,x,y,b,k,w,C,I,$,S,L,M,T,R,D,j,P;return s.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=n.length>2&&void 0!==n[2]&&n[2],i=n.length>3?n[3]:void 0,c=n.length>4?n[4]:void 0,!r.stopSubsequentRenders){s.next=6;break}return console.log("preventing render"),s.abrupt("return");case 6:if(e){s.next=8;break}return s.abrupt("return");case 8:if(u=i||[],r._runDirectives(),l=e.element,h=e.attrs,d=e.beforeRender,p=e.onrender,f=e.textContent,_=e._innerHTML,x=e.onUnmount,y=e.events,b=e.children,k=e.isRoute,r.__objDef(e,t,o,u,c),(k||o)&&r.unmountRoute(),!g(d)){s.next=23;break}if(!v(d)){s.next=20;break}return s.next=17,r._callFuncWithThis(d,e,null,u);case 17:w=s.sent,s.next=21;break;case 20:w=r._callFuncWithThis(d,e,null,u);case 21:if(!w||!w.stopExec){s.next=23;break}return s.abrupt("return");case 23:for(C=m.create(l,h),I={},e.idx&&(I[e.idx]=e),Object.assign(r.routeCache,E(b),I),e.$$element=C,e.$$parent=c||null,f||0===f?C.textContent=f:_&&(console.warn("innerHTML can be dangerous!"),C.innerHTML=_),$=Object.keys(y||{}),S=0;S<$.length;S++)L=$[S],C.addEventListener(L,t=>r._callFuncWithThis(y[L],e,C,t));for(M=!0,T=!1,R=void 0,s.prev=35,D=(b||[])[Symbol.iterator]();!(M=(j=D.next()).done);M=!0)P=j.value,r.render(P,C,!1,null,e);s.next=43;break;case 39:s.prev=39,s.t0=s.catch(35),T=!0,R=s.t0;case 43:s.prev=43,s.prev=44,M||null==D.return||D.return();case 46:if(s.prev=46,!T){s.next=49;break}throw R;case 49:return s.finish(46);case 50:return s.finish(43);case 51:if(o&&m.empty(t),t.appendChild(C),k&&(r.unMountFn=x||(()=>{})),!g(p)){s.next=61;break}if(!v(p)){s.next=60;break}return s.next=58,r._callFuncWithThis(p,e,C,u);case 58:s.next=61;break;case 60:r._callFuncWithThis(p,e,C,u);case 61:return s.abrupt("return",C);case 62:case"end":return s.stop()}},a,this,[[35,39,43,51],[44,,46,50]])}))()}registerRoute(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(e.route&&e.element&&"/"===e.route[0]||t))throw new Error("invalid values");if(!t){this.routes.includes(e.route)||this.routes.push(e.route);const t=e.element,r=e.children,n=e.selector,s=e.attrs,a=e.beforeRender,o=e.events,i=e.hasRouteArgs,c=e.onUnmount,u=e.onrender,l=e.route,h=e.textContent,d=e._innerHTML,p=e.idx;return this.routeMap[l]={idx:p,element:t,selector:n,beforeRender:a,onrender:u,hasRouteArgs:i,attrs:s,textContent:h,_innerHTML:d,events:o,children:r,onUnmount:c,isRoute:!0}}{const t=e.status;this.statusHandler[t]=e}}};function E(e){if(!e)return{};const t={};var r=!0,n=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){const e=a.value;e.idx&&(t[e.idx]=e)}}catch(e){n=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw s}}return t}w("router-data",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).appendChild((()=>Object.assign(document.createElement("style"),{innerHTML:":host{display:none}"}))())}});const S=function(){var e=o()(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",((r=document.createElement("link")).href=t,r.rel="stylesheet",document.head.appendChild(r)));case 4:e.prev=4,e.t0=e.catch(0),console.log("Could not append stylesheet",e.t0);case 7:case"end":return e.stop()}},e,this,[[0,4]])}));return function(t){return e.apply(this,arguments)}}();var L=r(2),M=r.n(L);class T extends HTMLElement{set size(e){const t=this.svg();t.style.height=t.style.width=e}get size(){return this.svg().style.height}set color(e){this.circle().style.stroke=e}get color(){return this.circle().style.stroke}set svgstyle(e){return this.svg().style=e}set circlestyle(e){return this.circle().style=e}static get observedAttributes(){return["size","color","svgstyle","circlestyle"]}attributeChangedCallback(e,t,r){"size"===e?this.size=r:"color"===e?this.color=r:"svgstyle"===e?this.svgstyle=r:"circlestyle"===e&&(this.circlestyle=r)}createTemplate(){const e=m.create("svg",{viewbox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}),t=m.create("circle",{fill:"none","stroke-width":6,"stroke-linecap":"round",cx:33,cy:33,r:30}),r=document.createElement("template");e.appendChild(t);const n=document.createElement("style");return n.innerHTML="svg{display:inline-block;width: 65px;height: 65px;animation:rotator 1.4s linear infinite}@keyframes rotator{0%{transform:rotate(0)}100%{transform:rotate(270deg)}}circle{stroke:#6f70ee;stroke-dasharray:120;stroke-dashoffset:0;transform-origin:center;animation:dash 1.4s ease-in-out infinite}@keyframes dash{0%{stroke-dashoffset:120}50%{stroke-dasharray:200;stroke-dashoffset:190;transform:rotate(135deg)}100%{stroke-dashoffset:120;transform:rotate(450deg)}}",r.innerHTML=n.outerHTML+e.outerHTML,r}constructor(e,t,r,n){super();const s=this.createTemplate();this.attachShadow({mode:"open"}).appendChild(s.content.cloneNode(!0)),this.svg=(()=>this.shadowRoot.querySelector("svg")),this.circle=(()=>this.shadowRoot.querySelector("circle")),e&&(this.size=e),t&&(this.color=t),r&&(this.svg().style=r),n&&(this.circle().style=n)}}w("mat-spinner",T);const R=window.location.host.includes("localhost")?"localhost:5000":"webmsg.herokuapp.com",D=`${window.location.protocol}//${R}`,j=e=>`${"https:"===window.location.protocol?"wss://":"ws://"}${R}/${e}`;class P{__defaultOnMessage(e){if(["ping","pong"].includes(e.data))return;const t=JSON.parse(e.data);this._socketID=t.socket_id}startConn(e){return new Promise((t,r)=>{this.socket=new WebSocket(j(e)),this.socket.onopen=(()=>{this.socket.send("__init__"),this.socket.onmessage=this.__defaultOnMessage,this._pingPongs(),t(this.socket)}),this.socket.onerror=(e=>r(e))})}close(){try{this.socket.close()}catch(e){console.warn(e)}}send(e){return this.socket.send(JSON.stringify(e))}sendString(e){return this.socket.send(e)}set onmessage(e){this.socket.onmessage=(t=>"ping"===t.data||"pong"===t.data?void 0:e(t))}get readyState(){return this.socket.readyState}get isUsable(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}_pingPongs(){this.pingtimer=setTimeout(()=>{this.socket.readyState===this.socket.OPEN?(this.socket.send("ping"),this._pingPongs()):clearTimeout(this.pingtimer)},2e4)}constructor(){}}let O;const A=()=>(O||{}).isUsable?O:O=new P;class U{static get(e){var t=arguments;return o()(s.a.mark(function r(){var n,a,o;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=!(t.length>1&&void 0!==t[1])||t[1],a=t.length>2&&void 0!==t[2]?t[2]:{},o=n?D+e:e,r.next=5,fetch(o,{headers:a,credentials:"include"});case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,this)}))()}static post(e){var t=arguments;return o()(s.a.mark(function r(){var n,a,o,i;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=!(t.length>1&&void 0!==t[1])||t[1],a=t.length>2?t[2]:void 0,o=t.length>3&&void 0!==t[3]?t[3]:{"content-type":"application/x-www-form-urlencoded"},i=n?D+e:e,r.next=6,fetch(i,{method:"post",body:a,headers:o,credentials:"include"});case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r,this)}))()}}const N=(()=>{const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const s={};return t.blur||(s.blur=function(){!function(e,t){if(!e.attrs.value||!e.attrs.value.trim()){const r=k(e,t);r.attrs.class.delete("moveup"),r.attrs.class.add("movedown"),r.update(),setTimeout(()=>(r.attrs.class.delete("movedown"),r.update()),110)}}(this,n),this.update()}),t.focus||(s.focus=function(){this.attrs.untouched=!1,function(e,t){const r=k(e,t);r.attrs.class.add("moveup"),r.attrs.class.delete("movedown"),r.update()}(this,n)},t.keydown||(s.keydown=function(e){85===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.$$element.value=this.$$element.value.slice(this.$$element.selectionStart,this.$$element.value.length),this.$$element.setSelectionRange(0,0))}),t.keyup||(s.keyup=function(){return this.attrs.value=this.$$element.value})),{idx:e,element:"input",attrs:{type:r?"password":"text",spellcheck:!1,class:"paper-input"},onrender(){this.attrs.value?this.$$element.focus():(this.attrs.untouched=!0,this.attrs.clean=!0)},events:M()({},t,s)}};return function(t,r,n,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{element:"div",children:[{idx:t,onrender(){const e=k(this,n);e&&e.$$element&&e.$$element.value.trim()&&(this.attrs.class=new Set(["_animate","moveup"]))},element:"div",textContent:r,attrs:{class:"_animate"}},e(n,s,a,t)]}}})(),H=(e,t)=>(console.log(e),t.registerRoute((e=>({element:"div",status:503,textContent:"An error occured while contacting the server..please reload the page and try again",attrs:{style:{margin:"auto","text-align":"center"},class:"_errComponent"},children:[{element:"button",attrs:{style:{background:"#fff",color:"#000",border:"1px solid #6f70ee","border-radius":"20px",display:"block",margin:"auto","margin-top":"20px",padding:"8px",width:"20%",outline:"none",cursor:"pointer"},class:"ripple"},textContent:"Reload",events:{click:()=>F(e)}}]}))(t),!0),setTimeout(()=>(t.pushStatus(503),t.stopSubsequentRenders=!0),500)),B=function(){var e=o()(s.a.mark(function e(){var t,r=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(r.length>0&&void 0!==r[0])||r[0],router.stopSubsequentRenders=!1,m.empty(router.root),router.root.appendChild(new T(null,null,_({margin:"auto",position:"fixed",top:0,bottom:0,left:0,right:0}))),router.root.appendChild((()=>{const e=m.create("div",{style:"margin:auto;text-align:center"});return e.textContent="Connecting to the server",e})()),e.next=7,U.get("/api/gen_204");case 7:setTimeout(()=>t?router.startLoad():void 0,450);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function F(e,t){return W.apply(this,arguments)}function W(){return(W=o()(s.a.mark(function e(t,r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G(()=>B(r),2,e=>H(e,t)));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}const q=new class{_setVars(){this.chatID=this.THERE=null}getIntegrity(){var e=this;return o()(s.a.mark(function t(){var r,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U.post("/api/integrity/",!0,x({integrity:e.Integrity}));case 2:return t.next=4,t.sent.json();case 4:return r=t.sent,n=r.key,e.Integrity=n,t.abrupt("return",n);case 8:case"end":return t.stop()}},t,this)}))()}getUser(){var e=this,t=arguments;return o()(s.a.mark(function r(){var n,a,o,i;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.length>0&&void 0!==t[0]&&t[0],a=t.length>1&&void 0!==t[1]&&t[1],navigator.onLine){r.next=4;break}return r.abrupt("return",localStorage.getItem("$$user"));case 4:if(!e.HERE||n){r.next=8;break}if(!a){r.next=7;break}return r.abrupt("return",e.HERE);case 7:return r.abrupt("return",!0);case 8:return r.prev=8,r.next=11,U.post("/api/getuser");case 11:if(!(o=r.sent).ok||o.error){r.next=23;break}return r.next=15,o.text();case 15:if(i=r.sent,e.HERE=i.substr(3),localStorage.setItem("$$user",e.HERE),!a){r.next=20;break}return r.abrupt("return",e.HERE);case 20:return r.abrupt("return",!0);case 23:return r.abrupt("return",!1);case 24:r.next=30;break;case 26:return r.prev=26,r.t0=r.catch(8),console.log(r.t0),r.abrupt("return",!1);case 30:case"end":return r.stop()}},r,this,[[8,26]])}))()}constructor(){this._setVars()}},G=function(){var e=o()(s.a.mark(function e(t,r,n){var a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=0;case 1:if(!(o<r)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2),a=e.t0;case 11:return e.next=13,(()=>new Promise(e=>{setTimeout(()=>e(),100)}))();case 13:o++,e.next=1;break;case 16:n(a);case 17:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}(),z=function(){var e=o()(s.a.mark(function e(t){var r,n,a,o=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=`/?${x({continue:t||location.hash.substr(1)})}`,a=`${location.protocol}//${location.host}/#${n}`,e.next=5,q.getUser(!0,!0);case 5:if(e.sent){e.next=15;break}if(a!=r.oldURL){e.next=12;break}return console.log("Same url navigation"),e.abrupt("return",{stopExec:!0});case 12:return e.abrupt("return",(console.log("Not logged in"),c(n),{stopExec:!0}));case 13:e.next=16;break;case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();r(9),r(10),r(11);var K=r(3),V=r.n(K),J=r(4),Y=r.n(J);class Q extends HTMLElement{createTemplate(){const e=m.create("div",{class:"bxcs"}),t=m.create("div",{class:"__div",textContent:this.title}),r=m.create("div",{textContent:this.body,class:"body"}),n=m.create("button",{class:"action",textContent:this.action1}),s=m.create("div");e.appendChild(t),e.appendChild(r),e.appendChild(s),s.appendChild(n);const a=m.create("template");return a.innerHTML=e.outerHTML+"<style>.action{cursor:pointer}.__div{font-weight:bold}.action,.bxcs{background-color:#fff}input{width:90%;border-radius:20px;border:2px solid #e3e3e3;padding:4px;outline:0}.bxcs{position:fixed;width:85%;margin:auto;right:0;left:0;top:2px;border-radius:10px;height:auto;padding:10px;z-index:20;box-shadow:0 2px 8px 0 #04040426}.action{color:#4749e4;font-weight:700;border:none;outline:0}</style>",a}startTick(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;this.$$timer=setTimeout(()=>this.remove(),e)}constructor(e,t,r,n,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6?arguments[6]:void 0;super(),this.title=e,this.body=t,this.bodyOnClick=r,this.action1=n,this.action1onClick=s||{},this.input=a;const i=this.createTemplate(),c=this.attachShadow({mode:"open"});if(c.appendChild(i.content.cloneNode(!0)),c.querySelector(".body").onclick=(()=>{r()}),this.action1onClick.showInput){let e;const t=c.querySelector(".action");this.input&&(e=m.create("input",{id:"input"})),e.onkeydown=(r=>{if(13===r.keyCode)return e.replaceWith(t),o(r),this.remove()}),t.onclick=(()=>{t.replaceWith(e),e.focus(),clearTimeout(this.$$timer)})}else c.querySelector(".action").onclick=(e=>s(e))}}w("mat-notify",Q);const Z=(e=>{const t=function(){var e=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();let r=t,n=t,a=t,i=t,c=t;if(indexedDB){class t{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"WebCache",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.storeName=r,this._dbase=new Promise((e,n)=>{const s=indexedDB.open(t,1);s.onerror=(t=>(console.log(t),e(null))),s.onsuccess=(()=>{e(s.result)}),s.onupgradeneeded=(()=>{s.result.createObjectStore(r)})})}__IDBAct__(e,t){return this._dbase.then(r=>new Promise((n,s)=>{const a=r.transaction(this.storeName,e);a.oncomplete=(()=>n()),a.onabort=a.onerror=(()=>s()),t(a.objectStore(this.storeName))})).catch(e=>(console.log(e),null))}}let s;const o=()=>s||new t;r=function(e){let t;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:o()).__IDBAct__("readonly",r=>{t=r.get(e)}).then(()=>t.result).catch(e=>(console.log(e),null))},n=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o();try{return r.__IDBAct__("readwrite",r=>{r.put(t,e)})}catch(e){return null}},c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o();try{t.__IDBAct__("readwrite",t=>{t.delete(e)})}catch(e){return null}},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o();try{return console.warn("clearing Store:",e),e.__IDBAct__("readwrite",e=>{e.clear()})}catch(e){return e}},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o();const t=[];return e.__IDBAct__("readonly",e=>{(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}}).then(()=>t).catch(e=>null)}}return{get:r,set:n,__clear__:i,keys:a,del:c}})("KeyStore");class X extends HTMLElement{constructor(e,t,r,n){let s=e.message,a=e.sender,o=e.receiver,i=e.stamp,c=e.read,u=e.rstamp,l=e.seen_read,h=e.edited;super(),this.message=s,"string"!=typeof s&&(this.media=this.message.media,this.mediaURL=this.message.mediaURL),this.sender=a,this.receiver=o,this.stamp=i,this.edited=h,this.read=c,this.rstamp=u,this.seen_read=l,this.$id=t;const d=document.createElement("template");this.user=n,d.innerHTML="<style>:host{display:flex;flex-direction:column}:host.received{textalign:left}:host.sent{text-align:right}[message]{text-align:justify;margin:5px;margin-bottom:0px;width:fit-content;border-radius:15px;max-width:45%;display:inline-flex;padding:6px;cursor:pointer;overflow-wrap:break-word;word-break:break-word}[message].sent{background:#d2e3fc;color:#174ea6;margin-left:auto}[message].received{margin-right:auto;background-color:#f1f3f4;color:#000000de}[time]{display:flex;font-weight:200;color: #0000005e;font-size:12px;margin:10px;margin-top:2px;-webkit-transition:.2s;transition:.2s;-webkit-transform:translate(0,0);transform:translate(0,0)}[time].sent{flex-direction:row-reverse;}[time].received{flex-direction:row}</style><div message></div><div time></div>";const p=this.attachShadow({mode:"open"});p.appendChild(d.content.cloneNode(!0)),this.msg=p.querySelector("div[message]"),this.time=p.querySelector("div[time]"),this.setAttribute("msg-id",this.$id),this.sender===r?(this.msg.classList.add("received"),this.time.classList.add("received"),this.classList.add("received")):this.sender===n&&(this.msg.classList.add("sent"),this.time.classList.add("sent"),this.classList.add("sent"));try{this.msg.appendChild(this._messageOrMedia())}catch(e){console.log(e,this)}this.time.textContent=this._GetInformativeTime(),this.onclick=(()=>{})}setRead(e,t){this.read=e,this.rstamp=t,this.shadowRoot.querySelector("div[time]").textContent=this._GetInformativeTime()}_messageOrMedia(){if(this.media){const e=document.createElement("img");return e.src=V.a,this.msg.onclick=(()=>{const e=document.createElement("a");e.href=this.mediaURL,e.target="__blank",e.click()}),e}if(this.message)return document.createTextNode(this.message)}_GetInformativeTime(){let e,t="",r="";return this.edited&&(r="[edited]"),this.sender!==this.user?e=this.stamp:this.read?(this.read&&(t="read "),e=this.rstamp):(t="sent ",e=this.stamp),r+t+y(e)}}w("text-message",X);const ee=e=>{if(l(location.href).path===`/chat/${e.chat_id}`)console.log("not showing notification for current chat");else{let t;t=e.message&&e.message.media?"media message":e.message;const r=new Q(e.sender,t,()=>c(`/chat/${e.chat_id}`),"reply",{showInput:!0},!0,function(){var t=o()(s.a.mark(function t(r){var n,a,o,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.target.value,(a=A()).isUsable&&a.socket){t.next=5;break}return t.next=5,a.startConn("_/data/");case 5:return o=b(),t.next=8,q.getUser(!1,!0);case 8:i=t.sent,c={details:{chat_id:e.chat_id,data:{sender:i,receiver:e.sender,message:n,stamp:o}}},U.post("/api/instant-message/",!0,JSON.stringify(c),{"content-type":"application/json"}),a.send({type:"message-relay",peer:e.sender,sender:i,data:{peer:e.sender,sender:i,type:"message-relay",data:{stamp:o,message:n,chat_id:e.chat_id,peer:e.sender}}});case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}());document.body.appendChild(r),r.startTick(2e3)}},te={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]},re=e=>{const t=m.create("div",{notification:!0,textContent:e});return t.onclick=(()=>t.remove()),t};class ne{static validateChatId(e){return o()(s.a.mark(function t(){var r,n,a,o,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U.post("/api/chat-stats",!0,x({chat_id:e}));case 2:return r=t.sent,t.next=5,r.json();case 5:if(!(n=t.sent).$$serviceWorker$$){t.next=8;break}return t.abrupt("return",n);case 8:if(!n.error){t.next=10;break}return t.abrupt("return",{error:n.error});case 10:return a=n.HERE,o=n.chat_with,i=n.chat_id,c=n.is_online,t.abrupt("return",{user:a,chat_id:i,peer:o,is_online:c});case 12:case"end":return t.stop()}},t,this)}))()}_onIceCandidate(e){let t=e.candidate;if(t&&this._pc)return this._socket.send({type:"rtc_data",data:{icecandidate:t},peer:this._peer})}_iceStateChange(){var e=this;this._pc.oniceconnectionstatechange=o()(s.a.mark(function t(){var r,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.__unrendering__){t.next=3;break}return t.abrupt("return");case 3:if(r=e._pc.iceConnectionState,!["closed","disconnected","failed"].includes(r)){t.next=17;break}return console.log("Connection is Dead.."),e._isOfferer=null,e._pc=null,e._dc=null,e.__USEWEBSOCKETFALLBACK__=!0,setTimeout(o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._startConn();case 2:case"end":return t.stop()}},t,this)})),2),t.next=13,ae(e._chat_id);case 13:n=t.sent,e.peer=n.peer,e._is_online=n.is_online,e.updateUI&&e.updateUI();case 17:t.next=21;break;case 19:t.prev=19,t.t0=t.catch(0);case 21:case"end":return t.stop()}},t,this,[[0,19]])}))}_onDataChannel(){console.log(`[isOfferer:${this._isOfferer}] started data channel`,this._dc),this._dc.addEventListener("message",e=>{let t=e.data;return u.emit("chat_message",t)}),this.__USEWEBSOCKETFALLBACK__=!1}_startRTCPings(){var e=this;return o()(s.a.mark(function t(){var r,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e._isOfferer,e._pc=new RTCPeerConnection(te),e._pc.onicecandidate=(t=>e._onIceCandidate(t)),e._pc.oniceconnectionstatechange=(t=>e._iceStateChange(t)),!r){t.next=15;break}return e._dc=e._pc.createDataChannel(h()),t.next=8,e._pc.createOffer();case 8:return n=t.sent,t.next=11,e._pc.setLocalDescription(n);case 11:e._socket.send({type:"rtc_data",data:{rtc:"offer",js:n},peer:e._peer}),u.emit("on-dataChannel"),t.next=16;break;case 15:e._pc.ondatachannel=(t=>{let r=t.channel;return e._dc=r,u.emit("on-dataChannel")});case 16:case"end":return t.stop()}},t,this)}))()}_parseRTCData(e){var t=this;return o()(s.a.mark(function r(){var n,a,o;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:if(console.log("Got rtc Data--\x3e",e),n=e.rtc,a=e.js,!(o=e.icecandidate)){r.next=11;break}if(!t._pc){r.next=11;break}return r.next=8,t._pc.addIceCandidate(o);case 8:return r.abrupt("return",r.sent);case 11:if("offer"!==n){r.next=21;break}return r.next=14,t._pc.setRemoteDescription(a);case 14:return r.t0=t._pc,r.next=17,t._pc.createAnswer();case 17:return r.t1=r.sent,r.next=20,r.t0.setLocalDescription.call(r.t0,r.t1);case 20:return r.abrupt("return",t._socket.send({type:"rtc_data",data:{rtc:"answer",js:t._pc.localDescription},peer:t._peer}));case 21:if("answer"!==n){r.next=24;break}return r.next=24,t._pc.setRemoteDescription(a);case 24:case"end":return r.stop()}},r,this)}))()}_onWSmessage(e){let t=e.data,r=void 0===t?{}:t;const n=JSON.parse(r),s=n.type,a=n.data,o=n.meta;if(o.from!==this._peer&&o.from!==this._user){if("start_chat"!==s&&"online_status"!==s){if("message-relay"===s){if(a.sender=o.from,a.sender===this._user)return;return ee(a)}return}const e=new Q("Start a Chat",`${o.from} is ready to chat!`,()=>c(`/chat/${a.common_chat_id}`),"Chat",console.log);return document.body.appendChild(e),e.startTick()}if(this._is_online||(this._is_online="--",this.updateUI()),"online_status"===s){const e=a.isonline;return this._is_online=e?"online":"offline",this.updateUI(),e?this._socket.send({type:"get_role",peer:this._peer}):void 0}if("get_role"===s)return this._socket.send({type:"send_role",data:{is_offerer:!!this._isOfferer},peer:this._peer});if("set_role"===s){if("boolean"==typeof this._isOfferer)return;return this._isOfferer=a.is_offerer,u.emit("use-rtc")}if("rtc_data"===s&&this._parseRTCData(a),"message-relay"===s&&u.emit("chat_message",a),"binary-file"===s){const e=re(`${this._peer} is sending a file`);document.body.appendChild(e),e.style.transform="translate(0px,0px)",setTimeout(()=>e.remove(),1500)}if("get-update"==s){const e=a.msgid;this.getElementByMessageId(e)&&this._socket.send({type:"update",peer:this._peer,data:{update_type:"read-update",details:{chat_id:this._chat_id,read:e,rstamp:b()}}})}"chat-update"===s&&this._updateMessages([a]),"ping-update"==s&&this._updateMessages(a)}get currentChatData(){return{chatID:this.chatID,user:this._user,peer:this._peer,is_online:this._is_online}}_startConn(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.updateUI(),u.EventCache["use-rtc"]&&u.detroyEvt("use-rtc"),u.listen("use-rtc",t=>t?e._startRTCPings():e._canUseRTC=!1),e._pc=null,e._isOfferer=null,e._dc=null,e._socket.isUsable&&e._socket.socket){t.next=10;break}return t.next=9,e._socket.startConn("_/data/");case 9:e.__updateTimeout__();case 10:if(e._socket.send({type:"start_chat",peer:e._peer}),e._socket.onmessage=(t=>e._onWSmessage.call(e,t)),"offline"!=e._is_online){t.next=15;break}return console.log("use websockets"),t.abrupt("return",e._canUseRTC=!1);case 15:case"end":return t.stop()}},t,this)}))()}get supportsRTC(){return!!window.RTCPeerConnection&&!!window.RTCDataChannel}get UseRTC(){return this.supportsRTC&&(this.PeerObject||{}).isOnline&&this._canUseRTC}}class se extends ne{updateUI(){try{const e=this.currentChatData,t=e.peer,r=e.is_online;this.peerbox=k(this._textarea,"peername"),this.peerstatus=k(this._textarea,"peerstatus"),this.peerbox.$$element.textContent=t,this.peerstatus.$$element.textContent=r}catch(e){}}_onUserMessage(e){let t,r=e.detail;try{t=i(r)?r:JSON.parse(r)}catch(e){return console.warn(e)}const n=t,s=n.type,a=n.sender,o=n.data;if("message-relay"===s){this._lastMessageID+=1;const e={},t=M()({},o,{sender:a,receiver:o.peer});e[this._lastMessageID]=t,console.log("UPDATE-----\x3e",e),ie(t.chat_id,e);const r=new X(t,this._lastMessageID,this._peer,this._user);return this._textarea.$$element.appendChild(r),r.scrollIntoView(),this._lastMessageID}"typing"===s&&a===this._peer&&(clearTimeout(this.___typingTimeout),this.peerstatus.$$element.textContent="typing",this.___typingTimeout=setTimeout(()=>{this.peerstatus.$$element.textContent=this._is_online},700))}_GenerateMessageTemplate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b();if(!e)throw new Error("Invalid Values");const r={type:"message-relay",peer:this._peer,sender:this._user,data:{chat_id:this._chat_id,msgid:this._lastMessageID,stamp:t,peer:this._peer}};return r.data.message=e,r}_sendTypingIndicator(){this._dc&&"open"===this._dc.readyState&&this._dc.send(JSON.stringify({type:"typing",sender:this._user}))}__sendMessage(e){return this.__USEWEBSOCKETFALLBACK__?this._socket.send(e):this._dc.send(JSON.stringify(e))}_sendMessageAndUpdateDataBase(e){const t=this._GenerateMessageTemplate(e);this._input.$$element.value="",this.__sendMessage(t);const r=this._onUserMessage({detail:M()({},t,{sender:this._user,receiver:this._peer})});this._sendServerPing(e,r)}_sendServerPing(e,t){var r=this;return o()(s.a.mark(function n(){var a,o,i,c;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a={chat_id:r._chat_id,data:{sender:r._user,receiver:r._peer,message:e,stamp:b()}},n.next=3,U.post("/api/instant-message/",!0,JSON.stringify({details:a}),{"content-type":"application/json"});case 3:return o=n.sent,n.next=6,o.json();case 6:i=n.sent,c=i.data,parseInt(c)!==parseInt(t)&&console.log("check for errors");case 9:case"end":return n.stop()}},n,this)}))()}_setUpDataInputListeners(){this._input.events.keydown=(e=>(function(e,t,r){return 85===e.keyCode&&e.ctrlKey?(e.preventDefault(),this.$$element.value=this.$$element.value.slice(this.$$element.selectionStart,this.$$element.value.length),this.$$element.setSelectionRange(0,0)):13===e.keyCode?(this.attrs.value||"").trim()&&t(this.$$element.value):this.attrs.value=this.$$element.value,r()}).call(this._input,e,e=>this._sendMessageAndUpdateDataBase.call(this,e),()=>this._sendTypingIndicator.call(this))),this._input.events.keyup=(()=>(function(){const e=(this.$$element.value||"").trim(),t=k(this,"sendbtn"),r=k(this,"attachbtn");return e?r.$$element.parentElement&&(r.$$element.style.transform="translate(200px,0px)",setTimeout(()=>(t.add(),r.remove()),170)):(r.add(),t.remove(),setTimeout(()=>r.$$element.style.transform="translate(0px,0px)",20)),this.attrs.value=this.$$element.value}).call(this._input)),this._input.reRender(),this._submit_button.events=this._submit_button.events||{},this._submit_button.events.click=(()=>this._sendMessageAndUpdateDataBase.call(this,this._input.$$element.value)),this._submit_button.reRender()}_updateMessages(e){var t=this;return o()(s.a.mark(function r(){var n,a,o,i,c,u,l,h,d,p,f,m;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=!0,a=!1,o=void 0,r.prev=3,i=e[Symbol.iterator]();case 5:if(n=(c=i.next()).done){r.next=23;break}if(u=c.value,l=u.update_type,h=u.msg,d=u.rstamp,p=u.chat_id,"read"!==l){r.next=20;break}return r.next=11,Z.get(p);case 11:if(!(f=r.sent)){r.next=19;break}return(m=f.chats)[h].read=!0,m[h].rstamp=d,f.chats=m,r.next=19,Z.set(p,f);case 19:t.getElementByMessageId(h).setRead(!0,d);case 20:n=!0,r.next=5;break;case 23:r.next=29;break;case 25:r.prev=25,r.t0=r.catch(3),a=!0,o=r.t0;case 29:r.prev=29,r.prev=30,n||null==i.return||i.return();case 32:if(r.prev=32,!a){r.next=35;break}throw o;case 35:return r.finish(32);case 36:return r.finish(29);case 37:case"end":return r.stop()}},r,this,[[3,25,29,37],[30,,32,36]])}))()}_renderFetchedMessages(e){const t=Object.keys(e),r=document.createElement("div");for(var n=0;n<t.length;n++){const s=t[n],a=e[s];if(this._lastMessageID=parseInt(s),!this.getElementByMessageId(s)){const e=new X(a,s,this._peer,this._user);r.appendChild(e),this._textarea.$$element.appendChild(r)}}}_getUpdatesFromServer(){var e=this;return o()(s.a.mark(function t(){var r,n,a,o,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z.get(e._chat_id);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return r=t.t0,console.log("IDB Data Recieved"),n=r.chats||{},e._renderFetchedMessages(n),e._lastMessageID=Object.keys(n).length-1,e._latestMessageElement&&e._latestMessageElement.scrollIntoView(),t.next=13,U.post("/api/updates/",!0,x({chat_id:e._chat_id,fetch_from:e._lastMessageID}));case 13:return a=t.sent,t.next=16,a.json();case 16:return o=t.sent,i=o.message_data.messages,e._renderFetchedMessages(i),t.next=21,ie(e._chat_id,i);case 21:e._latestMessageElement&&e._latestMessageElement.scrollIntoView();case 22:case"end":return t.stop()}},t,this)}))()}_sendBinaryFile(e){var t=this;return o()(s.a.mark(function r(){var n,a,o,i,c,u;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=re(`Sending File to ${t._peer}`),document.body.appendChild(n),n.style.transform="translate(0px,0px)",setTimeout(()=>n.remove(),1500),a=new Response(e),r.next=7,a.arrayBuffer();case 7:return o=r.sent,t._socket.send({type:"binary-file",data:{},peer:t._peer}),r.next=11,U.post("/@/binary/",!0,o);case 11:return i=r.sent,r.next=14,i.json();case 14:c=r.sent,u=c.url,t._sendMessageAndUpdateDataBase({media:!0,mediaURL:u});case 17:case"end":return r.stop()}},r,this)}))()}get _latestMessageElement(){if(this._lastMessageID)return this.getElementByMessageId(this._lastMessageID)}getElementByMessageId(e){return m.q(`text-message[msg-id="${e}"]`)}__updateTimeout__(){var e=this;this.__socketInterval__=setInterval(o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._getUnreadMessages();case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return");case 5:e._socket.send({type:"fetch-update",data:{msgids:r,chat_id:e._chat_id},peer:e._peer});case 6:case"end":return t.stop()}},t,this)})),5e3)}_getUnreadMessages(){var e=this;return o()(s.a.mark(function t(){var r,n,a,o,i,c,u;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,Z.get(e._chat_id);case 3:if(t.t0=t.sent,t.t0){t.next=6;break}t.t0={};case 6:if(n=t.t0,!(a=n.chats)){t.next=23;break}o=Object.keys(a),i=0;case 11:if(!(i<o.length)){t.next=22;break}if(c=o[i],!(u=a[c]).read&&u.sender===e._user){t.next=18;break}return t.abrupt("continue",19);case 18:r.push(c);case 19:i++,t.next=11;break;case 22:return t.abrupt("return",r.length?r:null);case 23:return t.abrupt("return",null);case 24:case"end":return t.stop()}},t,this)}))()}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A();super(),clearInterval(this.__socketInterval__),u.destroyAll(),u.listen("attach-img",e=>{let t=e.detail;return this._sendBinaryFile.call(this,t)}),u.listen("chat_message",e=>this._onUserMessage.call(this,e)),u.listen("on-dataChannel",e=>this._onDataChannel(e)),u.listen("unmount-router",()=>{u.destroyAll(),this._pc&&(this._socket.close(),clearInterval(this.__socketInterval__),this.__unrendering__=!0,this._pc.close(),this._pc=this._dc=this._peer=this._chat_id=this._isOfferer=null)}),this.__unrendering__=!1,this.__USEWEBSOCKETFALLBACK__=!0,this._isOfferer=null,this._canUseRTC=!0;const n=e.user,s=e.chat_id,a=e.peer,o=e.is_online;this._user=n,this._peer=a,this._is_online=o,this._chat_id=s,this._textarea=t,this._input=k(this._textarea,"chat_type"),this._submit_button=k(this._textarea,"sendbtn"),this._socket=r,this._getUpdatesFromServer(),this._startConn(),this._setUpDataInputListeners()}}function ae(e){return oe.apply(this,arguments)}function oe(){return(oe=o()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.validateChatId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ie(e,t){return ce.apply(this,arguments)}function ce(){return(ce=o()(s.a.mark(function e(t,r){var n,a,o,i,c=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(c.length>2&&void 0!==c[2])||c[2],e.next=3,Z.get(t);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:if(a=e.t0,!n){e.next=16;break}return o=a.chats,i=M()({},o,r),a.chats=i,e.next=13,Z.set(t,a);case 13:return e.abrupt("return",e.sent);case 16:return a.meta=r,e.next=19,Z.set(t,a);case 19:return e.abrupt("return",e.sent);case 20:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}const ue={element:"div",attrs:{class:"inpbox_"},children:[{element:"input",idx:"chat_type",attrs:{class:"textBox",spellcheck:"false",autocomplete:"none"},events:{}},{element:"img",idx:"attachbtn",events:{click(){const e=m.create("input",{type:"file"});e.oninput=(()=>u.emit("attach-img",e.files[0])),e.click()},contextmenu(e){e.preventDefault()}},attrs:{src:V.a,class:"attach-img"}},{idx:"sendbtn",element:"button",textContent:"send",attrs:{class:"send-btn"},onrender(){this.remove()}}]};var le={route:"/chat/",element:"div",attrs:{},beforeRender(e){var t=this;return o()(s.a.mark(function r(){var n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,z(t.currentRoute,t.getRouter().navData);case 2:if(!(n=r.sent)){r.next=5;break}return r.abrupt("return",{stopExec:n});case 5:if((e||[])[0]){r.next=9;break}return t.getRouter().pushStatus(500,"No Chat ID Provided"),r.abrupt("return",{stopExec:!0});case 9:case"end":return r.stop()}},r,this)}))()},onUnmount:()=>(console.log("unmounting"),u.emit("unmount-router"),document.body.style.overflow="auto",document.body.style.background=document.documentElement.style.background="#e3e3e3"),onrender(e){var t=this;return o()(s.a.mark(function r(){var n,a,o,i,c,u,l,h,d,p;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=k(t,"contentmain"),document.body.style.overflow="hidden",document.body.style.background=document.documentElement.style.background="#fff",i=e[0],c=m.create("mat-spinner",{style:"position:absolute;top:0;bottom:0;right:0;left:0;margin-top:30%"}),t.getRouter().root.appendChild(c),r.next=8,Z.get(i);case 8:if(r.t0=r.sent,r.t0){r.next=11;break}r.t0={};case 11:return u=r.t0,(l=u.meta)&&(c.remove(),a=!0,o=new se(l,n)),r.next=16,ae(i);case 16:if(!(h=r.sent).$$serviceWorker$$){r.next=19;break}return r.abrupt("return");case 19:if(o&&(d=o._is_online,o._is_online=h.is_online,"offline"!==d&&o._canUseRTC||"online"!==h.is_online||o._startConn(),o.updateUI()),(p=h).is_online=void 0,c.remove(),ie(i,p,!1),!l){r.next=28;break}if(l.peer===h.peer&&l.chat_id===h.chat_id){r.next=28;break}return console.error("error!"),r.abrupt("return",t.getRouter().pushStatus(500,"An Error occured while loading the chat data..please reload the page and try again"));case 28:if(!h.error){r.next=32;break}return r.abrupt("return",t.getRouter().pushStatus(500,h.error));case 32:if(!a){r.next=34;break}return r.abrupt("return");case 34:return r.abrupt("return",new se(h,n));case 35:case"end":return r.stop()}},r,this)}))()},children:[{idx:"header",element:"div",attrs:{class:"header-div"},children:[{element:"div",attrs:{style:"display:grid"},children:[{element:"div",idx:"peername",attrs:{class:"peername"}},{element:"div",idx:"peerstatus",attrs:{class:"peerstatus"}}]},{element:"div",attrs:{class:"menuimg"},children:[{element:"img",attrs:{src:Y.a},events:{click(){},contextmenu:e=>e.preventDefault()}}]}]},{element:"div",idx:"contentmain",attrs:{class:"ChatContent"}},{element:"div",idx:"inputbox",attrs:{class:"footer"},children:[ue]}]};if(window.Notification){if("undefined"==typeof firebase)throw new Error("hosting/init-error: Firebase SDK not detected. You must include it before /__/firebase/init.js");firebase.initializeApp({apiKey:"AIzaSyCrdjBktQNWizVmfjK50I7BGsIQcNFmKcI",databaseURL:"https://webmsg-py.firebaseio.com",storageBucket:"webmsg-py.appspot.com",authDomain:"webmsg-py.firebaseapp.com",messagingSenderId:"193257233140",projectId:"webmsg-py"})}function he(){return de.apply(this,arguments)}function de(){return(de=o()(s.a.mark(function e(){var t,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof window.Notification){e.next=20;break}return t=firebase.messaging(),e.prev=2,console.log("Supports Notifications"),t.usePublicVapidKey("BGhv7XYjPBkpVoOEPbq2E19Is1ti_MYfboTDazKE0jgxPENxDqe0-U2p1OKEEgG4JH4Ycl8Wbxdv-UrrP_LcLmw"),e.next=7,t.requestPermission();case 7:return e.next=9,t.getToken();case 9:return r=function(){var e=o()(s.a.mark(function e(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getToken();case 2:return r=e.sent,console.log("Token refreshed:"),console.log(r),e.next=7,U.post("/api/set-notification-token/",!0,x({token:r}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.next=12,r();case 12:t.onTokenRefresh(r),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.warn(e.t0),console.log("Permission-Denied");case 19:"granted"===Notification.permission&&(console.log("Granted Notification Perm"),t.onMessage(function(){var e=o()(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=JSON.parse(t.data.data),ee(r);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 20:case"end":return e.stop()}},e,this,[[2,15]])}))).apply(this,arguments)}w("mat-checkbox",class extends HTMLElement{set checked(e){const t=this.button;this._checked=!!e,e?t.classList.add("clicked"):t.classList.remove("clicked");const r=new Event("check");r.checked=this.checked,this.dispatchEvent(r)}set oncheck(e){this.eventListener=e,this.addEventListener("check",e)}get checked(){return this._checked}static get observedAttributes(){return["checked","boxstyle","buttonstyle"]}attributeChangedCallback(e,t,r){if("checked"===e){let t;return t="false"!==r&&"0"!==r,"checked"===e?this.checked=t:void 0}return"boxstyle"===e?this.boxtyle=r:"buttonstyle"===e?this.buttonstyle=r:void 0}_createTemplate(){const e=document.createElement("div"),t=document.createElement("button");e.appendChild(t);const r=document.createElement("template"),n=document.createElement("style");return n.innerHTML="div{-webkit-tap-highlight-color:transparent;background-color:#fff;cursor:pointer;border-radius:100px;height:20px;width:50px;display:inline-flex;border:2px solid #e3e3e3}button{box-shadow:0 1px 5px 0 #0009;display:block;margin-top:auto;margin-bottom:auto;height:inherit;border-radius:100%;border:none;width:20px;transition:all .2s ease-in-out 0s;cursor:pointer;outline:0}button.clicked{margin-left:30px;background-color:#033577}",r.innerHTML=n.outerHTML+e.outerHTML,r}set boxtyle(e){return this.box.style=e}set buttonstyle(e){return this.button.style=e}constructor(e,t){super();const r=this._createTemplate();this.attachShadow({mode:"open"}).appendChild(r.content.cloneNode(!0)),this.button=(()=>this.shadowRoot.querySelector("button"))(),this.box=(()=>this.shadowRoot.querySelector("div"))(),this.box.addEventListener("click",e=>(e.stopImmediatePropagation(),this.checked?this.checked=!1:this.checked=!0)),e&&(this.box.style=e),t&&(this.button.style=t)}});const pe=(e,t)=>({element:"button",children:[{element:"a",textContent:e,attrs:{href:`#/chat/${t}`,class:"result_name"}}],events:{click:e=>(c(`/chat/${t}`),e.preventDefault())},attrs:{class:"searchresult"}});function fe(e){const t=k(this,"prevChatsData"),r=k(this,"prevChatsMessage");this.attrs._checked=e.checked;const n=k(this,"loading-spinner");function a(){return(a=o()(s.a.mark(function e(){var a,o,i,c,u,l,h,d,p,f,m;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=localStorage.getItem("previous_chats"))){e.next=8;break}t.children=JSON.parse(a),t.safeRerender(),n.remove(),this.add(),e.next=55;break;case 8:if(this.remove(),r.remove(),n.add(),!navigator.onLine){e.next=26;break}return e.t0=U,e.t1=x,e.next=16,q.getUser(!1,!0);case 16:return e.t2=e.sent,e.t3={user:e.t2},e.t4=(0,e.t1)(e.t3),e.next=21,e.t0.post.call(e.t0,"/api/chat_ids/",!0,e.t4);case 21:return i=e.sent,e.next=24,i.json();case 24:(o=e.sent).previous_chats&&localStorage.setItem("previous_chats",JSON.stringify(o.previous_chats));case 26:if((c=(o||{}).previous_chats||JSON.parse(localStorage.getItem("previous_chats")||"[]")).length){e.next=31;break}return n.remove(),r.$$element.textContent="An error occured while searching for your chats",e.abrupt("return");case 31:for(u=[],l=!0,h=!1,d=void 0,e.prev=35,p=c[Symbol.iterator]();!(l=(f=p.next()).done);l=!0)m=f.value,u.push(pe(m.user,m.chat_id));e.next=43;break;case 39:e.prev=39,e.t5=e.catch(35),h=!0,d=e.t5;case 43:e.prev=43,e.prev=44,l||null==p.return||p.return();case 46:if(e.prev=46,!h){e.next=49;break}throw d;case 49:return e.finish(46);case 50:return e.finish(43);case 51:t.children=u,t.safeRerender(t),n.remove(),this.add();case 55:r.add(),r.attrs.textContent="Your Previous Chats",r.update();case 58:case"end":return e.stop()}},e,this,[[35,39,43,51],[44,,46,50]])}))).apply(this,arguments)}e.checked?function(){return a.apply(this,arguments)}.call(this):(r.attrs.textContent="Click to show your previous chats",r.update(),t.remove())}var me={element:"div",route:"/u/",attrs:{},beforeRender(e){var t=this;return o()(s.a.mark(function r(){var n,a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(m.empty(t.getRouter().root),!(n=z(t.currentRoute,t.getRouter().navData))){r.next=4;break}return r.abrupt("return",n);case 4:if((a=e[0])&&a===user){r.next=7;break}return r.abrupt("return",(c(`/u/${user}`),{stopExec:!0}));case 7:case"end":return r.stop()}},r,this)}))()},onrender:()=>((()=>{if("function"==typeof Notification){if("default"===Notification.permission){const e=m.create("div",{notification:!0,textContent:"Click to enable notification service. Long press or right click to remove this dialog",_routerif:"this.routeParser(location).includes('/u/')",events:{contextmenu(e){e.target.remove()}}});return document.body.appendChild(e),e.style.transform="translate(0px,0px)",e.onclick=(()=>{e.remove(),he()})}he()}})(),document.documentElement.style.backgroundColor=document.body.style.backgroundColor="#ffffff"),onUnmount:()=>document.documentElement.style.backgroundColor=document.body.style.backgroundColor="#e3e3e3",children:[{element:"div",attrs:{},children:[N("searchHint","Search for users","userSearch",{keydown(e){var t=this;return o()(s.a.mark(function r(){var n,a,o,i,c,u,l,h,d,p,f,m,g,v,_,y;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(85!==e.keyCode||!e.ctrlKey){r.next=4;break}return e.preventDefault(),t.$$element.value="",r.abrupt("return");case 4:if(13!==e.keyCode){r.next=57;break}if((n=k(t,"resultBox")).attrs.textContent="",n.update(),n.children=[],n.reRender(),!(a=(t.attrs.value||"").trim())){r.next=57;break}return(o=k(t,"search-spinner")).add(),r.next=16,q.getIntegrity();case 16:return i=r.sent,r.next=19,U.get(`/api/user-search/tokens/${i}`);case 19:return c=r.sent,r.next=22,c.text();case 22:return u=r.sent,r.next=25,U.post("/api/users/",!0,x({token:u,user:a}));case 25:return l=r.sent,r.next=28,l.json();case 28:if(h=r.sent,(d=h.users||[]).length){r.next=34;break}return n.attrs.textContent="No Users Found",n.update(),r.abrupt("return",o.remove());case 34:for(p=[],f=!0,m=!1,g=void 0,r.prev=38,v=d[Symbol.iterator]();!(f=(_=v.next()).done);f=!0)y=_.value,p.push(pe(y.user,y.chat_id));r.next=46;break;case 42:r.prev=42,r.t0=r.catch(38),m=!0,g=r.t0;case 46:r.prev=46,r.prev=47,f||null==v.return||v.return();case 49:if(r.prev=49,!m){r.next=52;break}throw g;case 52:return r.finish(49);case 53:return r.finish(46);case 54:n.children=p,o.remove(),n.reRender(n);case 57:case"end":return r.stop()}},r,this,[[38,42,46,54],[47,,49,53]])}))()}}),{idx:"search-spinner",element:"mat-spinner",attrs:{svgstyle:"margin:auto;margin-top:10px"},onrender(){this.remove()}},{element:"div",attrs:{},idx:"resultBox",children:[]}]},{idx:"prevChatsUI",element:"div",attrs:{style:{width:"80%",margin:"auto","border-top":"1px solid #000","margin-top":"10px"}},onrender:()=>o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}))(),children:[{attrs:{boxstyle:_({"margin-top":"20px"})},element:"mat-checkbox",events:{check(e){var t=this;return o()(s.a.mark(function r(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:G(()=>fe.call(t,e),1,e=>{console.log(e),k(t,"loading-spinner").remove();const r=k(t,"prevChatsMessage");return r.attrs.textContent="Could not find previus chats",r.update(),t.remove()});case 1:case"end":return r.stop()}},r,this)}))()}}},{idx:"prevChatsMessage",element:"div",textContent:"Click to show your previous chats"},{idx:"loading-spinner",element:"mat-spinner",attrs:{svgstyle:"margin:auto"},onrender(){this.remove()}},{idx:"prevChatsData",element:"div",onrender(){this.remove()}}]}]};const ge=e=>{const t=k(e,"__errorbox__");return t.textContent="Loading..",t.attrs.style.visibility="visible",t.reRender(t),t},ve={login:{fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",no_such_user:"No Such User Exists",incorrect_password:"incorrect password"},register:{fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",bad_request:"Bad Username or Password",username_taken:"Username Already Taken"}};function _e(e,t){const r=(this.attrs.value||t.target.value).trim(),n=k(this,`${e}UserPH`);if(n.attrs.class.delete("error"),n.attrs.textContent="username",n.update(),r){if(!ye(r))return n.attrs.class.add("error"),n.attrs.textContent="Invalid Username",n.update(),this.attrs.hasError=!0;this.attrs.hasError=!1,13===t.keyCode&&k(this,`${e}PasswordInput`).$$element.focus()}}function xe(e){_e.call(this,"login",e)}const ye=e=>{if(0<e.length)return/^[0-9a-zA-Z_.-]+$/.test(e)};function be(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"password";const s=e.target.value,a=k(this,t);if(a.attrs.textContent=n,a.attrs.class.delete("error"),a.update(),13===e.keyCode)return!s.trim()||4>s.length?(a.attrs.class.add("error"),a.attrs.textContent="Invalid Password",a.update(),this.attrs.hasError=!0):(this.attrs.hasError=!1,r())}const ke=N("loginUserPH","username","loginUserInput",{keydown:xe,keyup(e){this.attrs.value=this.$$element.value,xe.call(this,e)}}),we=N("signupUserPH","username","signupUserInput",{keydown:function(e){_e.call(this,"signup",e)},keyup(e){this.attrs.value=this.$$element.value,xe.call(this,e)}});var Ce={element:"div",attrs:{id:"auth-component",style:{margin:"auto","text-align":"center"}},beforeRender(){var e=this;return o()(s.a.mark(function t(){var r,n,a,o,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q.getUser(!0);case 2:if(!t.sent){t.next=16;break}if(r=l(location),n=r.qs,a=new URLSearchParams(n),!(o=a.get("continue"))){t.next=11;break}return c(o),t.abrupt("return",{stopExec:!0});case 11:if(i=`/u/${q.HERE}`,!e.getRouter().isUserGoingBack(i)){t.next=14;break}return t.abrupt("return",{stopExec:!0});case 14:return c(i),t.abrupt("return",{stopExec:!0});case 16:case"end":return t.stop()}},t,this)}))()},onrender:()=>console.log("Rendered Login Component"),children:[{idx:"loginBtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},textContent:"Login",events:{click(){const e=k(this,"sgupbx"),t=k(this,"loginBox");e.remove(),t.add()}}},{element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},textContent:"signup",events:{click(){const e=k(this,"sgupbx"),t=k(this,"loginBox");e.add(),t.remove()}}},{element:"div",idx:"__errorbox__",attrs:{style:{visibility:"hidden",color:"#ff0000","font-weight":"bold"},textContent:""}},{element:"div",attrs:{id:"loginBox",style:{border:"2px solid #e3e3e3"}},onrender(){this.remove()},children:[ke,N("loginPasswordPH","password","loginPasswordInput",{keydown(e){return be.call(this,e,"loginPasswordPH",()=>(function(e){const t=ge(e),r=k(e,"loginUserInput");if(r.attrs.hasError||e.attrs.hasError)return;const n=r.$$element.value,a=e.$$element.value;return G(o()(s.a.mark(function e(){var r,o,i,u,h,d,p;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=U,e.t1=x,e.t2=n,e.t3=a,e.next=6,q.getIntegrity();case 6:return e.t4=e.sent,e.t5={user:e.t2,password:e.t3,integrity:e.t4},e.t6=(0,e.t1)(e.t5),e.next=11,e.t0.post.call(e.t0,"/login/check/",!0,e.t6);case 11:return r=e.sent,e.next=14,r.json();case 14:if(o=e.sent,r.ok&&!o.error){e.next=19;break}return i=ve.login[o.error],t.textContent=i||"An unknown error occured on our end..",e.abrupt("return",t.reRender(t));case 19:if(!o.success){e.next=27;break}return t.$$element.textContent="Authenticated",u=l(location),h=u.qs,d=new URLSearchParams(h),p=d.get("continue"),c(p||`/u/${o.user}`),t.textContent="",e.abrupt("return",t.reRender(t));case 27:case"end":return e.stop()}},e,this)})),2,e=>(console.log(e),t.textContent="An error occured..please try again",t.reRender(t)))})(this))},keyup(){this.attrs.value=this.$$element.value}},!0)],idx:"loginBox"},{element:"div",attrs:{id:"signupBox",style:{border:"2px solid #e3e3e3"}},onrender(){this.remove()},children:[we,N("signupPasswordPH","password","signupPasswordInput",{keydown(e){return be.call(this,e,"signupPasswordPH",()=>k(this,"signupPassConfInput").$$element.focus())},keyup(){this.attrs.value=this.$$element.value}},!0),N("signupPassConfPH","confirm password","signupPassConfInput",{keydown(e){return be.call(this,e,"signupPassConfPH",()=>(function(e){const t=ge(e),r=k(e,"signupUserInput"),n=k(e,"signupPasswordInput");if(r.attrs.hasError||e.attrs.hasError||n.hasError)return;const a=r.$$element.value,i=n.$$element.value,c=e.$$element.value;G(o()(s.a.mark(function e(){var r,n,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=U,e.t1=x,e.t2=a,e.t3=i,e.t4=c,e.next=7,q.getIntegrity();case 7:return e.t5=e.sent,e.t6={user:e.t2,password:e.t3,checkpw:e.t4,integrity:e.t5},e.t7=(0,e.t1)(e.t6),e.next=12,e.t0.post.call(e.t0,"/register/check/",!0,e.t7);case 12:return r=e.sent,e.next=15,r.json();case 15:if(n=e.sent,r.ok&&!n.error){e.next=20;break}return o=ve.register[n.error],t.textContent=o||"An unknown error occured on our end..",e.abrupt("return",t.reRender(t));case 20:if(!n.success){e.next=23;break}return t.textContent="Account Created. Please Login",e.abrupt("return",t.reRender(t));case 23:case"end":return e.stop()}},e,this)})),2,()=>t.$$element.textContent="An Unknown error occured..please try again")})(this),"confirm password")},keyup(){this.attrs.value=this.$$element.value}},!0)],idx:"sgupbx"}],route:"/"},Ie=r(5),$e=r.n(Ie);S("https://fonts.googleapis.com/css?family=Open+Sans"),window.router=$;const Ee=$,Se=m.id("app-banner");Se&&(Se.style.display="block");const Le={route:"/logout/",element:"div",beforeRender:()=>Ee.isUserGoingBack("/")?{stopExec:!0}:(localStorage.clear(),Z.__clear__(),U.post("/api/logout/").then(()=>{$.load("/")})),textContent:"Logging you out"};Ee.registerRoute(Le),o()(s.a.mark(function e(){var t,r,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[le,me,Ce],r=0;r<t.length;r++)n=t[r],Ee.registerRoute(n);case 2:case"end":return e.stop()}},e,this)}))(),F(Ee,!1).then(()=>Ee.startLoad());if("serviceWorker"in navigator&&(()=>"localhost"!==location.hostname)()){$e.a.register().then(e=>console.log("SW registered.",e.scope))}}]);